{"version":3,"sources":["block_inactiveusers.js"],"names":["define","$","Chart","cfg","V","common","init","notifyListner","panel","getPanel","panelBody","panelTitle","table","tableWrapper","loader","dropdown","dropdownToggle","inActiveUsersTable","exportUrlLink","getInactiveUsersData","filter","show","ajax","url","requestUrl","type","dataType","data","action","sesskey","JSON","stringify","done","response","remove","destroy","hide","DataTable","aaSorting","oLanguage","sEmptyTable","sSearchPlaceholder","columnDefs","targets","className","drawCallback","addClass","responsive","lengthChange","bInfo","fail","error","console","log","always","length","on","this","find","val","html","changeExportUrl","filterReplaceFlag"],"mappings":"AAAA,aAGAA,OAAO,CAAC,SAAU,eAAgB,qCAAsC,iCAAkC,WAAY,yCAA0C,8CAA+C,SAAUC,EAAGC,EAAOC,EAAKC,EAAGC,GAwHzO,MAAO,CACLC,KApHF,SAAcC,GACZ,IACIC,EAAQL,EAAIM,SAAS,uBACrBC,EAAYP,EAAIM,SAAS,sBAAuB,QAChDE,EAAaR,EAAIM,SAAS,sBAAuB,SACjDG,EAAQF,EAAY,uBACpBG,EAAeH,EAAY,+BAC3BI,EAASJ,EAAY,WACrBK,EAAWJ,EAAa,iCACxBK,EAAiBL,EAAa,0BAC9BM,EAAqB,KACrBC,EAAgBV,EAAQ,oEAsC5B,SAASW,EAAqBC,GAE5Bf,EAAOS,OAAOO,KAAK,uBACnBpB,EAAEqB,KAAK,CACLC,IAAKpB,EAAIqB,WACTC,KAAM,MACNC,SAAU,OACVC,KAAM,CACJC,OAAQ,8BACRC,QAAS5B,EAAEO,GAAOmB,KAAK,WACvBA,KAAMG,KAAKC,UAAU,CACnBX,OAAQA,OAGXY,KAAK,SAAUC,GAgBpB,IAAkCN,EAAAA,EAfLM,EAASN,KAiBhCV,IAEFhB,EAAE,6BAA6BiC,SAC/BjB,EAAmBkB,WAIrBlC,EAAEa,GAAQsB,OACVnC,EAAEW,GAAOS,OAETJ,EAAqBhB,EAAEW,GAAOyB,UAAU,CACtCV,KAAMA,EAENW,UAAW,CAAC,CAAC,EAAG,SAChBC,UAAW,CACTC,YAAa,mCACbC,mBAAoB,gBAEtBC,WAAY,CAAC,CACXC,QAAW,EACXC,UAAa,gBAEfC,aAAc,WACZ5C,EAAE,sCAAsC6C,SAAS,4BACjD7C,EAAE,sBAAsB6C,SAAS,6BAEnCC,YAAY,EACZC,cAAc,EACdC,OAAO,MA5CNC,KAAK,SAAUC,GAChBC,QAAQC,IAAIF,KACXG,OAAO,WACR/C,EAAc,iBAEdF,EAAOS,OAAOsB,KAAK,yBAzDnBnC,EAAEO,GAAO+C,QAEXpC,EAAqBlB,EAAEc,GAAUY,KAAK,UAKtC1B,EAAEc,GAAUyC,GAAG,QAAS,WAEtB,IAAIpC,EAASnB,EAAEwD,MAAM9B,KAAK,SAC1B1B,EAAEO,GAAOkD,KAAK,wCAAwCC,IAAIvC,GAO1DnB,EAAEa,GAAQO,OACVpB,EAAEW,GAAOwB,OACTnC,EAAEY,GAAcuB,OAEhBnC,EAAEe,GAAgB4C,KAAK3D,EAAEwD,MAAMG,QAE/BzD,EAAI0D,gBAAgBzC,EAAQF,EAAed,EAAE0D,mBAE7C3C,EAAqBlB,EAAEwD,MAAM9B,KAAK,aAGpCpB,EAAc","sourcesContent":["/* eslint-disable no-console */\r\ndefine([\r\n    'jquery',\r\n    'core/chartjs',\r\n    'local_edwiserreports/defaultconfig',\r\n    'local_edwiserreports/variables',\r\n    './common',\r\n    'local_edwiserreports/jquery.dataTables',\r\n    'local_edwiserreports/dataTables.bootstrap4'\r\n], function(\r\n    $,\r\n    Chart,\r\n    cfg,\r\n    V,\r\n    common\r\n) {\r\n\r\n    /**\r\n     * Initialize\r\n     * @param {function} notifyListner Callback function\r\n     */\r\n    function init(notifyListner) {\r\n        var activeUsersTable;\r\n        var panel = cfg.getPanel(\"#inactiveusersblock\");\r\n        var panelBody = cfg.getPanel(\"#inactiveusersblock\", \"body\");\r\n        var panelTitle = cfg.getPanel(\"#inactiveusersblock\", \"title\");\r\n        var table = panelBody + \" #inactiveuserstable\";\r\n        var tableWrapper = panelBody + \" #inactiveuserstable_wrapper\";\r\n        var loader = panelBody + \" .loader\";\r\n        var dropdown = panelTitle + \" .dropdown-menu .dropdown-item\";\r\n        var dropdownToggle = panelTitle + \" button.dropdown-toggle\";\r\n        var inActiveUsersTable = null;\r\n        var exportUrlLink = panel + \" .dropdown-menu[aria-labelledby='export-dropdown'] .dropdown-item\";\r\n\r\n        if ($(panel).length) {\r\n            // Get inactive users data on load\r\n            getInactiveUsersData($(dropdown).data(\"value\"));\r\n\r\n            /**\r\n             * On click of dropdown get inactive user list based on filter\r\n             */\r\n            $(dropdown).on(\"click\", function() {\r\n                // Get filter\r\n                var filter = $(this).data(\"value\");\r\n                $(panel).find('.download-links input[name=\"filter\"]').val(filter);\r\n\r\n                // If table is already created then destroy the tablw\r\n                if (activeUsersTable) {\r\n                    activeUsersTable.destroy();\r\n                }\r\n\r\n                // Show load and remove table\r\n                $(loader).show();\r\n                $(table).hide();\r\n                $(tableWrapper).hide();\r\n\r\n                // Set dropdown button value\r\n                $(dropdownToggle).html($(this).html());\r\n\r\n                // Change export data url\r\n                cfg.changeExportUrl(filter, exportUrlLink, V.filterReplaceFlag);\r\n\r\n                // Get inactive users\r\n                getInactiveUsersData($(this).data(\"value\"));\r\n            });\r\n        } else {\r\n            notifyListner(\"inActiveUsers\");\r\n        }\r\n\r\n        /**\r\n         * Get inactive users list based on filter\r\n         * @param  {string} filter Filter\r\n         */\r\n        function getInactiveUsersData(filter) {\r\n\r\n            // Show loader.\r\n            common.loader.show('#inactiveusersblock');\r\n\r\n            $.ajax({\r\n                url: cfg.requestUrl,\r\n                type: 'GET',\r\n                dataType: 'json',\r\n                data: {\r\n                    action: 'get_inactiveusers_data_ajax',\r\n                    sesskey: $(panel).data(\"sesskey\"),\r\n                    data: JSON.stringify({\r\n                        filter: filter\r\n                    })\r\n                },\r\n            })\r\n                .done(function(response) {\r\n                    createInactiveUsersTable(response.data);\r\n                })\r\n                .fail(function(error) {\r\n                    console.log(error);\r\n                }).always(function() {\r\n                    notifyListner(\"inActiveUsers\");\r\n\r\n                    // Hide loader.\r\n                    common.loader.hide('#inactiveusersblock');\r\n                });\r\n        }\r\n\r\n        /**\r\n         * Create inactive users table\r\n         * @param  {String} data Table data\r\n         */\r\n        function createInactiveUsersTable(data) {\r\n            // If table is creted then destroy table\r\n            if (inActiveUsersTable) {\r\n                // Remove table data first\r\n                $(\"#inactiveuserstable tbody\").remove();\r\n                inActiveUsersTable.destroy();\r\n            }\r\n\r\n            // Display loader\r\n            $(loader).hide();\r\n            $(table).show();\r\n\r\n            // Create inactive users table\r\n            inActiveUsersTable = $(table).DataTable({\r\n                data: data,\r\n                // Dom : '<\"pull-left\"f><t>',\r\n                aaSorting: [[2, 'desc']],\r\n                oLanguage: {\r\n                    sEmptyTable: \"No inactive users are available.\",\r\n                    sSearchPlaceholder: \"Search Users\"\r\n                },\r\n                columnDefs: [\r\n                    {\r\n                        \"targets\": 2,\r\n                        \"className\": \"text-center\"\r\n                    }\r\n                ],\r\n                drawCallback: function() {\r\n                    $('.dataTables_paginate > .pagination').addClass('pagination-sm pull-right');\r\n                    $('.dataTables_filter').addClass('pagination-sm pull-right');\r\n                },\r\n                responsive: true,\r\n                lengthChange: false,\r\n                bInfo: false\r\n            });\r\n        }\r\n    }\r\n\r\n    // Must return the init function\r\n    return {\r\n        init: init\r\n    };\r\n});\r\n"],"file":"block_inactiveusers.min.js"}