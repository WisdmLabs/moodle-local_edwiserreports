define(["jquery","core/modal_factory","core/modal_events","core/fragment","core/templates","report_elucidsitereport/variables","report_elucidsitereport/jquery.dataTables","report_elucidsitereport/dataTables.bootstrap4","report_elucidsitereport/common"],function(s,u,m,p,e,h){return{init:function(r){var e="#wdm-courseengage-individual",t=e+" .table",o=e+" .loader",a=s(e).data("sesskey"),n=h.requestUrl+"?action=get_courseengage_data_ajax&sesskey="+a,l=null,d="#cohortfilter",c=0;function i(e){s(t).show(),s(o).hide(),l=s(t).DataTable({ajax:n+"&cohortid="+e,dom:'<"pull-left"f><t><p>',columns:[{data:"coursename"},{data:"enrolment"},{data:"visited"},{data:"activitystart"},{data:"completedhalf"},{data:"coursecompleted"}],columnDefs:[{className:"text-left",targets:0},{className:"text-center modal-trigger",targets:"_all"}],language:{searchPlaceholder:"Search courses",emptyTable:"There are no courses"},scrollY:350,scrollX:!0,paginate:!1,sScrollX:"100%",bScrollCollapse:!0})}s(document).ready(function(){i(c),s(document).on("click","#cohortfilter ~ .dropdown-menu .dropdown-item",function(){l&&(l.destroy(),s(t).hide(),s(o).show()),c=s(this).data("cohortid"),h.changeExportUrl(c,".dropdown-menu[aria-labelledby='export-dropdown'] .dropdown-item",h.cohortReplaceFlag),s(d).html(s(this).text()),i(c)}),s(document).on("click",'a[href="#engagement"]',function(){s(window).resize()}),s(document).on("click","#wdm-courseengage-individual .table a.modal-trigger",function(){var e=s(this).data("action"),t=s(this).data("courseid"),o=s(this).data("coursename"),a=null;u.create({body:p.loadFragment("report_elucidsitereport","userslist",r,{page:"courseengage",courseid:t,action:e,cohortid:c})}).then(function(e){a=e.getRoot(),e.setTitle(o),e.show(),a.on(m.hidden,function(){e.destroy()}),a.on(m.shown,function(){s(window).resize()}),a.on(m.bodyRendered,function(){var e=a.find(".modal-table");e.find("tbody").hasClass("empty")&&e.find("tbody").empty(),a.find(".modal-table").DataTable({language:{searchPlaceholder:"Search users",emptyTable:"There are no users"},scrollY:"350px",scrollX:!0,paging:!1,bInfo:!1})})})})})}}});