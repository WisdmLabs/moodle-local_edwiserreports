define(["jquery","core/chartjs","report_elucidsitereport/defaultconfig","report_elucidsitereport/variables","report_elucidsitereport/select2"],function(p,i,g,u){return{init:function(){var r=null,o=g.getPanel("#courseprogressblock"),a=g.getPanel("#courseprogressblock","body"),t=(g.getPanel("#courseprogressblock","header"),g.getPanel("#courseprogressblock","footer"),a+" #wdm-courseprogress-select"),s=a+" .ct-chart",n=a+" .loader",l=o+" .dropdown-menu[aria-labelledby='export-dropdown'] .dropdown-item",c=!1;function d(){var e=p(t).val();g.changeExportUrl(e,l,u.filterReplaceFlag),p.ajax({url:g.requestUrl,type:"GET",dataType:"json",data:{action:"get_courseprogress_graph_data_ajax",sesskey:p(o).data("sesskey"),data:JSON.stringify({courseid:e})}}).done(function(e){c.graph.data=e.data}).fail(function(e){console.log(e)}).always(function(){!function(){var e={labels:c.graph.labels,datasets:[{label:c.graph.label,data:c.graph.data,backgroundColor:c.graph.backgroundColor}]};r=new i(c.ctx,{data:e,type:c.graph.type,options:c.graph.options})}(),p(n).addClass("d-none"),p(s).removeClass("d-none")})}p(document).ready(function(e){(c=g.getCourseProgressBlock())&&(d(),e(a+" .singleselect").select2(),e(t).on("change",function(){e(s).addClass("d-none"),e(n).removeClass("d-none"),r&&r.destroy(),d()}))})}}});