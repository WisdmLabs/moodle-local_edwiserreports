define(["jquery","core/chartjs","report_elucidsitereport/defaultconfig","report_elucidsitereport/variables","report_elucidsitereport/select2"],function(g,i,u,f){return{init:function(r){var o=null,a=u.getPanel("#courseprogressblock"),t=u.getPanel("#courseprogressblock","body"),s=(u.getPanel("#courseprogressblock","header"),u.getPanel("#courseprogressblock","footer"),t+" #wdm-courseprogress-select"),n=t+" .ct-chart",l=t+" .loader",c=a+" .dropdown-menu[aria-labelledby='export-dropdown'] .dropdown-item",d=!1;function p(){var e=g(s).val();u.changeExportUrl(e,c,f.filterReplaceFlag),g.ajax({url:u.requestUrl,type:"GET",dataType:"json",data:{action:"get_courseprogress_graph_data_ajax",sesskey:g(a).data("sesskey"),data:JSON.stringify({courseid:e})}}).done(function(e){d.graph.data=e.data}).fail(function(e){console.log(e)}).always(function(){!function(){var e={labels:d.graph.labels,datasets:[{label:d.graph.label,data:d.graph.data,backgroundColor:d.graph.backgroundColor}]};o=new i(d.ctx,{data:e,type:d.graph.type,options:d.graph.options})}(),g(l).addClass("d-none"),g(n).removeClass("d-none"),r("courseProgress")})}g(document).ready(function(e){(d=u.getCourseProgressBlock())&&(p(),e(t+" .singleselect").select2(),e(s).on("change",function(){e(n).addClass("d-none"),e(l).removeClass("d-none"),o&&o.destroy(),p()}))})}}});