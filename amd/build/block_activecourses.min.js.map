{"version":3,"sources":["block_activecourses.js"],"names":["define","$","Chart","cfg","common","init","notifyListner","activeCourseTable","panel","getPanel","panelBody","loader","table","length","show","ajax","url","requestUrl","type","requestType","dataType","requestDataType","data","action","sesskey","done","response","destroy","DataTable","responsive","aaSorting","aoColumns","orderSequence","language","searchPlaceholder","initComplete","hide","fadeIn","drawCallback","addClass","columnDefs","targets","className","orderable","lengthChange","bInfo","fail","error","console","log","always","on","column","search","order","nodes","each","cell","i","innerHTML","draw"],"mappings":"AAAA,aAGAA,OAAO,CAAC,SAAU,eAAgB,qCAAsC,WAAY,yCAA0C,8CAA+C,SAAUC,EAAGC,EAAOC,EAAKC,GAkHpM,MAAO,CACLC,KA9GF,SAAcC,GACZ,IAAIC,EACAC,EAAQL,EAAIM,SAAS,uBACrBC,EAAYP,EAAIM,SAAS,sBAAuB,QAChDE,EAASD,EAAY,WACrBE,EAAQF,EAAY,UAEpBT,EAAEO,GAAOK,QAEXT,EAAOO,OAAOG,KAAK,uBAGnBb,EAAEc,KAAK,CACLC,IAAKb,EAAIc,WACTC,KAAMf,EAAIgB,YACVC,SAAUjB,EAAIkB,gBACdC,KAAM,CACJC,OAAQ,8BACRC,QAASvB,EAAEO,GAAOc,KAAK,cAExBG,KAAK,SAAUC,GAuCpB,IAAiCJ,EAAAA,EArCLI,EAASJ,KAuC/Bf,GACFA,EAAkBoB,UAKpBpB,EAAoBN,EAAEW,GAAOgB,UAAU,CACrCC,YAAY,EACZP,KAAMA,EACNQ,UAAW,CAAC,CAAC,EAAG,SAChBC,UAAW,CAAC,KAAM,KAAM,CACtBC,cAAiB,CAAC,SACjB,CACDA,cAAiB,CAAC,SACjB,CACDA,cAAiB,CAAC,UAEpBC,SAAU,CACRC,kBAAmB,iBAErBC,aAAc,WAEZlC,EAAEU,GAAQyB,OACVnC,EAAEW,GAAOyB,OAAO,SAElBC,aAAc,WACZrC,EAAE,sCAAsCsC,SAAS,4BACjDtC,EAAE,sBAAsBsC,SAAS,6BAEnCC,WAAY,CAAC,CACXC,QAAW,EACXC,UAAa,cACbC,WAAa,GACZ,CACDF,QAAW,EACXC,UAAa,YACbC,WAAa,GACZ,CACDF,QAAW,OACXC,UAAa,gBAEfE,cAAc,EACdC,OAAO,MAhFNC,KAAK,SAAUC,GAChBC,QAAQC,IAAIF,KACXG,OAAO,WAER3C,EAAkB4C,GAAG,qBAAsB,WACzC5C,EAAkB6C,OAAO,EAAG,CAC1BC,OAAQ,UACRC,MAAO,YACNC,QAAQC,KAAK,SAAUC,EAAMC,GAE5BD,EAAKE,UADE,GAALD,EACe,yCACH,GAALA,EACQ,2CACH,GAALA,EACQ,2CAEAA,EAAI,IAGzBzD,EAAEW,EAAQ,0BAA0B2B,SAAS,cAC5CqB,OAGHtD,EAAc,iBAEdF,EAAOO,OAAOyB,KAAK,0BAGrB9B,EAAc","sourcesContent":["/* eslint-disable no-console */\r\ndefine([\r\n    'jquery',\r\n    'core/chartjs',\r\n    'local_edwiserreports/defaultconfig',\r\n    './common',\r\n    'local_edwiserreports/jquery.dataTables',\r\n    'local_edwiserreports/dataTables.bootstrap4'\r\n], function($, Chart, cfg, common) {\r\n    /**\r\n     * Initialize\r\n     * @param {function} notifyListner Callback function\r\n     */\r\n    function init(notifyListner) {\r\n        var activeCourseTable;\r\n\r\n        var panel = cfg.getPanel(\"#activecoursesblock\");\r\n        var panelBody = cfg.getPanel(\"#activecoursesblock\", \"body\");\r\n        var loader = panelBody + \" .loader\";\r\n        var table = panelBody + \" .table\";\r\n\r\n        if ($(panel).length) {\r\n            // Show loader.\r\n            common.loader.show('#activecoursesblock');\r\n\r\n            /* Ajax request to get data for active courses table */\r\n            $.ajax({\r\n                url: cfg.requestUrl,\r\n                type: cfg.requestType,\r\n                dataType: cfg.requestDataType,\r\n                data: {\r\n                    action: 'get_activecourses_data_ajax',\r\n                    sesskey: $(panel).data(\"sesskey\")\r\n                },\r\n            }).done(function(response) {\r\n                /* Create active course table */\r\n                createActiveCourseTable(response.data);\r\n            })\r\n            .fail(function(error) {\r\n                console.log(error);\r\n            })\r\n            .always(function() {\r\n                /* Added fixed column rank in datatable */\r\n                activeCourseTable.on('order.dt search.dt', function() {\r\n                    activeCourseTable.column(0, {search: 'applied', order: 'applied'}).nodes().each(function(cell, i) {\r\n                        if (i == 0) {\r\n                            cell.innerHTML = \"<i class='fa fa-trophy text-gold'></i>\";\r\n                        } else if (i == 1) {\r\n                            cell.innerHTML = \"<i class='fa fa-trophy text-silver'></i>\";\r\n                        } else if (i == 2) {\r\n                            cell.innerHTML = \"<i class='fa fa-trophy text-bronze'></i>\";\r\n                        } else {\r\n                            cell.innerHTML = i + 1;\r\n                        }\r\n                    });\r\n                    $(table + \" td:not(.bg-secondary)\").addClass(\"bg-white\");\r\n                }).draw();\r\n\r\n                /* Notify that this event is completed */\r\n                notifyListner(\"activeCourses\");\r\n\r\n                // Hide loader.\r\n                common.loader.hide('#activecoursesblock');\r\n            });\r\n        } else {\r\n            notifyListner(\"activeCourses\");\r\n        }\r\n\r\n        /**\r\n         * Create active course table.\r\n         * @param {object} data Table data object\r\n         */\r\n        function createActiveCourseTable(data) {\r\n            /* If datable already created the destroy the table*/\r\n            if (activeCourseTable) {\r\n                activeCourseTable.destroy();\r\n            }\r\n\r\n            /* Create datatable for active courses */\r\n            activeCourseTable = $(table).DataTable({\r\n                responsive: true,\r\n                data: data,\r\n                aaSorting: [[2, 'desc']],\r\n                aoColumns: [\r\n                    null,\r\n                    null,\r\n                    {\"orderSequence\": [\"desc\"]},\r\n                    {\"orderSequence\": [\"desc\"]},\r\n                    {\"orderSequence\": [\"desc\"]}\r\n                ],\r\n                language: {\r\n                    searchPlaceholder: \"Search Course\"\r\n                },\r\n                initComplete: function() {\r\n                    /* Remove laoder and display table after table is created */\r\n                    $(loader).hide();\r\n                    $(table).fadeIn(\"slow\");\r\n                },\r\n                drawCallback: function() {\r\n                    $('.dataTables_paginate > .pagination').addClass('pagination-sm pull-right');\r\n                    $('.dataTables_filter').addClass('pagination-sm pull-right');\r\n                },\r\n                columnDefs: [\r\n                    {\r\n                        \"targets\": 0,\r\n                        \"className\": \"text-center\",\r\n                        \"orderable\": false\r\n                    },\r\n                    {\r\n                        \"targets\": 1,\r\n                        \"className\": \"text-left\",\r\n                        \"orderable\": false\r\n                    },\r\n                    {\r\n                        \"targets\": \"_all\",\r\n                        \"className\": \"text-center\",\r\n                    }\r\n                ],\r\n                lengthChange: false,\r\n                bInfo: false\r\n            });\r\n        }\r\n    }\r\n\r\n    // Must return the init function\r\n    return {\r\n        init: init\r\n    };\r\n});\r\n"],"file":"block_activecourses.min.js"}