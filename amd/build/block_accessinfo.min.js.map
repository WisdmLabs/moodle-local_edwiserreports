{"version":3,"sources":["block_accessinfo.js"],"names":["define","$","templates","cfg","common","panel","getPanel","panelBody","table","loader","accessDesc","init","notifyListner","document","ready","length","show","ajax","url","requestUrl","type","requestType","dataType","requestDataType","data","action","sesskey","done","response","render","getTemplate","then","html","js","replaceNodeContents","fail","ex","console","log","always","remove","removeClass","tooltip","hide","error"],"mappings":"AAAA,aAGAA,OAAO,CAAC,SAAU,iBAAkB,qCAAsC,YAAa,SAAUC,EAAGC,EAAWC,EAAKC,GAClH,IAAIC,EAAQF,EAAIG,SAAS,oBACrBC,EAAYJ,EAAIG,SAAS,mBAAoB,QAC7CE,EAAQL,EAAIG,SAAS,mBAAoB,SACzCG,EAASN,EAAIG,SAAS,mBAAoB,UAC1CI,EAAa,uBAuDjB,MAAO,CACLC,KAlDF,SAAcC,GACZX,EAAEY,UAAUC,MAAM,WAQZb,EAAEI,GAAOU,QAEXX,EAAOK,OAAOO,KAAK,oBACnBf,EAAEgB,KAAK,CACLC,IAAKf,EAAIgB,WACTC,KAAMjB,EAAIkB,YACVC,SAAUnB,EAAIoB,gBACdC,KAAM,CACJC,OAAQ,2BACRC,QAASzB,EAAEI,GAAOmB,KAAK,cAExBG,KAAK,SAAUC,GAEhB1B,EAAU2B,OAAO1B,EAAI2B,YAAY,mBAAoBF,EAASJ,MAAMO,KAAK,SAAUC,EAAMC,GACvF/B,EAAUgC,oBAAoB3B,EAAWyB,EAAMC,KAE9CE,KAAK,SAAUC,GAChBC,QAAQC,IAAIF,KACXG,OAAO,WACRtC,EAAES,GAAYM,OACdf,EAAEQ,GAAQ+B,SACVvC,EAAEO,GAAOiC,YAAY,UACrBxC,EAAEI,EAAQ,4BAA4BqC,UAEtCtC,EAAOK,OAAOkC,KAAK,wBAEpBR,KAAK,SAAUS,GAChBP,QAAQC,IAAIM,KACXL,OAAO,WACR3B,EAAc,cAEdR,EAAOK,OAAOkC,KAAK,uBAGrB/B,EAAc","sourcesContent":["/* eslint-disable no-console */\r\ndefine([\r\n    'jquery',\r\n    'core/templates',\r\n    'local_edwiserreports/defaultconfig',\r\n    './common'\r\n], function($, templates, cfg, common) {\r\n    var panel = cfg.getPanel(\"#siteaccessblock\");\r\n    var panelBody = cfg.getPanel(\"#siteaccessblock\", \"body\");\r\n    var table = cfg.getPanel(\"#siteaccessblock\", \"table\");\r\n    var loader = cfg.getPanel(\"#siteaccessblock\", \"loader\");\r\n    var accessDesc = \"#accessinfodesctable\";\r\n\r\n    /**\r\n     * Initialize\r\n     * @param {function} notifyListner Callback function\r\n     */\r\n    function init(notifyListner) {\r\n        $(document).ready(function() {\r\n            generateAccessInfoGraph();\r\n        });\r\n\r\n        /**\r\n         * Generate access info graph\r\n         */\r\n        function generateAccessInfoGraph() {\r\n\r\n            if ($(panel).length) {\r\n                // Show loader.\r\n                common.loader.show('#siteaccessblock');\r\n                $.ajax({\r\n                    url: cfg.requestUrl,\r\n                    type: cfg.requestType,\r\n                    dataType: cfg.requestDataType,\r\n                    data: {\r\n                        action: 'get_siteaccess_data_ajax',\r\n                        sesskey: $(panel).data(\"sesskey\")\r\n                    },\r\n                })\r\n                .done(function(response) {\r\n                    // eslint-disable-next-line promise/catch-or-return\r\n                    templates.render(cfg.getTemplate(\"siteaccessblock\"), response.data)\r\n                    .then(function(html, js) {\r\n                        templates.replaceNodeContents(panelBody, html, js);\r\n                        return;\r\n                    })\r\n                    .fail(function(ex) {\r\n                        console.log(ex);\r\n                    })\r\n                    .always(function() {\r\n                        $(accessDesc).show();\r\n                        $(loader).remove();\r\n                        $(table).removeClass(\"d-none\");\r\n                        $(panel + ' [data-toggle=\"tooltip\"]').tooltip();\r\n\r\n                        // Hide loader.\r\n                        common.loader.hide('#siteaccessblock');\r\n                    });\r\n                })\r\n                .fail(function(error) {\r\n                    console.log(error);\r\n                }).always(function() {\r\n                    notifyListner(\"accessInfo\");\r\n\r\n                    // Hide loader.\r\n                    common.loader.hide('#siteaccessblock');\r\n                });\r\n            } else {\r\n                notifyListner(\"accessInfo\");\r\n            }\r\n        }\r\n    }\r\n\r\n    // Must return the init function\r\n    return {\r\n        init: init\r\n    };\r\n});\r\n"],"file":"block_accessinfo.min.js"}