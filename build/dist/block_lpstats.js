define(["jquery","core/chartjs","report_elucidsitereport/defaultconfig","report_elucidsitereport/variables","report_elucidsitereport/select2"],(function(e,a,t,l){return{init:function(s){var o=null,n=t.getPanel("#lpstatsblock"),r=t.getPanel("#lpstatsblock","body"),d=(t.getPanel("#lpstatsblock","title"),r+" #wdm-lpstats-select"),c=n+" .dropdown-menu[aria-labelledby='export-dropdown'] .dropdown-item",p=r+" .ct-chart",i=r+" .loader",u=!1;function g(l){e.ajax({url:t.requestUrl,type:t.requestType,dataType:t.requestDataType,sesskey:e(n).data("sesskey"),data:{action:"get_lpstats_data_ajax",sesskey:e(n).data("sesskey"),data:JSON.stringify({lpid:l})}}).done((function(e){!function(e){if(u){u.graph.labels=e.labels,u.graph.data=e.data;var t={labels:u.graph.labels,datasets:[{data:u.graph.data,backgroundColor:u.graph.backgroundColor}]};o=new a(u.ctx,{data:t,type:u.graph.type,options:u.graph.options})}}(e.data)})).fail((function(e){console.log(e)})).always((function(){e(i).addClass("d-none"),e(p).removeClass("d-none"),s("lpStatsBlock")}))}e(document).ready((function(){var a=e(d).val();(u=t.getLpStatsBlock())?(g(a),e(r+" .singleselect").select2(),e(d).on("change",(function(){a=e(this).val(),e(p).addClass("d-none"),e(i).removeClass("d-none"),t.changeExportUrl(a,c,l.filterReplaceFlag),o.destroy(),g(a)}))):s("lpStatsBlock")}))}}}));