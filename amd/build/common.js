define(["jquery","core/notification","core/fragment","core/modal_factory","core/modal_events","report_elucidsitereport/variables","report_elucidsitereport/select2","report_elucidsitereport/jquery.dataTables","report_elucidsitereport/dataTables.bootstrap4"],function(o,i,t,n,r,e){function a(e){var t="#wdm-elucidsitereport > div";e<780?o(t).addClass("col-lg-12"):o(t).removeClass("col-lg-12"),o(document).find(".table.dataTable").DataTable().draw()}o(document).ready(function(){a(o("#page-admin-report-elucidsitereport-index .page-content").width()),o(window).on("resize",function(){a(e.pluginPage.width())}),o(document).on("click",'.export-dropdown a[data-action="email"]',function(e){e.preventDefault();var a=this;n.create({type:n.types.SAVE_CANCEL,title:"Email Dialog Box",body:t.loadFragment("report_elucidsitereport","email_dialog",o(a).data("contextid"),{blockname:o(a).data("blockname")})},o(this)).done(function(e){var t=e.getRoot();t.on(r.hidden,function(){e.destroy()}),t.on(r.save,function(){!function(e,t){o.ajax({url:e.href,type:"POST",data:t.find("form").serialize()}).done(function(e){(e=o.parseJSON(e)).error?i.addNotification({message:e.errormsg,type:"error"}):i.addNotification({message:"Email has been sent",type:"info"})}).fail(function(){i.addNotification({message:"Failed to send the email",type:"error"})})}(a,t)}),e.setSaveButtonText("Send"),e.show()})}),o(document).on("click",'.export-dropdown a[data-action="emailscheduled"]',function(e){e.preventDefault();var a=this;n.create({title:"Schedule Emails",body:t.loadFragment("report_elucidsitereport","schedule_email_dialog",o(a).data("contextid"),{blockname:o(a).attr("data-blockname"),href:o(a).attr("href"),region:o(a).attr("data-region")})},o(this)).done(function(e){var t=e.getRoot();t.addClass("esr-schedule-email"),t.on(r.hidden,function(){e.destroy()}),t.on("click",'[data-action="save"]',function(){o.ajax({url:a.href,type:"POST",data:t.find("form").serialize()}).done(function(e){e=o.parseJSON(e),console.log(e)}).fail(function(){i.addNotification({message:"Failed to send the email",type:"error"})})}),e.show()})})})});