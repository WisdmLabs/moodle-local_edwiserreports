define(["jquery","core/chartjs","report_elucidsitereport/defaultconfig","report_elucidsitereport/variables","report_elucidsitereport/select2"],(function(e,r,o,a){return{init:function(t){var s=null,l=o.getPanel("#courseprogressblock"),n=o.getPanel("#courseprogressblock","body"),c=(o.getPanel("#courseprogressblock","header"),o.getPanel("#courseprogressblock","footer"),n+" #wdm-courseprogress-select"),d=n+" .ct-chart",p=n+" .loader",u=l+" .dropdown-menu[aria-labelledby='export-dropdown'] .dropdown-item",g=!1;function i(){var n=e(c).val();o.changeExportUrl(n,u,a.filterReplaceFlag),s&&s.destroy(),e.ajax({url:o.requestUrl,type:o.requestType,dataType:o.requestDataType,data:{action:"get_courseprogress_graph_data_ajax",sesskey:e(l).data("sesskey"),data:JSON.stringify({courseid:n})}}).done((function(e){g.graph.data=e.data})).fail((function(e){console.log(e)})).always((function(){var o;o={labels:g.graph.labels,datasets:[{label:g.graph.label,data:g.graph.data,backgroundColor:g.graph.backgroundColor}]},s=new r(g.ctx,{data:o,type:g.graph.type,options:g.graph.options}),e(p).hide(),e(d).fadeIn("slow"),t("courseProgress")}))}e(document).ready((function(e){(g=o.getCourseProgressBlock())?(i(),e(n+" .singleselect").select2(),e(c).on("change",(function(){e(d).hide(),e(p).show(),i()}))):t("courseProgress")}))}}}));