define(["jquery","core/chartjs","report_elucidsitereport/defaultconfig","report_elucidsitereport/variables","report_elucidsitereport/select2"],function(i,u,g,y){return{init:function(a){var t=null,l=g.getPanel("#lpstatsblock"),s=g.getPanel("#lpstatsblock","body"),o=(g.getPanel("#lpstatsblock","title"),s+" #wdm-lpstats-select"),n=l+" .dropdown-menu[aria-labelledby='export-dropdown'] .dropdown-item",r=s+" .ct-chart",d=s+" .loader",c=!1;function p(e){i.ajax({url:g.requestUrl,type:g.requestType,dataType:g.requestDataType,sesskey:i(l).data("sesskey"),data:{action:"get_lpstats_data_ajax",sesskey:i(l).data("sesskey"),data:JSON.stringify({lpid:e})}}).done(function(e){!function(e){if(c){c.graph.labels=e.labels,c.graph.data=e.data;var a={labels:c.graph.labels,datasets:[{data:c.graph.data,backgroundColor:c.graph.backgroundColor}]};t=new u(c.ctx,{data:a,type:c.graph.type,options:c.graph.options})}}(e.data)}).fail(function(e){console.log(e)}).always(function(){i(d).addClass("d-none"),i(r).removeClass("d-none"),a("lpStatsBlock")})}i(document).ready(function(){var e=i(o).val();(c=g.getLpStatsBlock())?(p(e),i(s+" .singleselect").select2(),i(o).on("change",function(){e=i(this).val(),i(r).addClass("d-none"),i(d).removeClass("d-none"),g.changeExportUrl(e,n,y.filterReplaceFlag),t.destroy(),p(e)})):a("lpStatsBlock")})}}});