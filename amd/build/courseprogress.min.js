define(["jquery","core/modal_factory","core/modal_events","core/fragment","core/templates","report_elucidsitereport/variables","report_elucidsitereport/jquery.dataTables","report_elucidsitereport/dataTables.bootstrap4","report_elucidsitereport/common"],(function(e,o,r,t,a,s){return{init:function(l){var i="#wdm-courseprogress-individual",n=i+" .table",d=i+" .loader",c=null,u=0,p=null;function h(o){p=e(i).data("sesskey"),e.ajax({url:s.requestUrl,data:{action:"get_courseprogress_graph_data_ajax",sesskey:p,data:JSON.stringify({courseid:"all",cohortid:o})}}).done((function(o){var r={courseprogress:o,sesskey:p};a.render("report_elucidsitereport/courseprogress",r).then((function(o,r){a.replaceNode(i,o,r),c=e(n).DataTable({dom:'<"pull-left"f><t><p>',order:[[0,"desc"]],bLengthChange:!1,initComplete:function(){e("#wdm-courseprogress-individual .dataTables_wrapper .row:first-child > div:first-child .dropdown").show()},columnDefs:[{targets:0,className:"text-left"},{targets:"_all",className:"text-center"}],language:{searchPlaceholder:"Search courses",emptyTable:"There are no courses"},scrollY:350,scrollX:!0,paginate:!1,sScrollX:"100%",bScrollCollapse:!0}),e(n).show(),e(d).hide()})).fail((function(e){console.log(e)})).always((function(){e(window).resize()}))})).fail((function(e){console.log(e)}))}e(document).ready((function(){h(u),e(document).on("click","#cohortfilter ~ .dropdown-menu .dropdown-item",(function(){c&&(c.destroy(),e(n).hide(),e(d).show()),u=e(this).data("cohortid"),e("#cohortfilter").html(e(this).text()),h(u)})),e(document).on("click","#wdm-courseprogress-individual .table a.modal-trigger",(function(){var a=e(this).data("minvalue"),s=e(this).data("maxvalue"),i=e(this).data("courseid"),n=e(this).data("coursename"),d=null;o.create({body:t.loadFragment("report_elucidsitereport","userslist",l,{page:"courseprogress",courseid:i,minval:a,maxval:s,cohortid:u})}).then((function(e){d=e.getRoot(),e.setTitle(n),e.show(),d.on(r.hidden,(function(){e.destroy()})),d.on(r.bodyRendered,(function(){var e=d.find(".modal-table");e.find("tbody").hasClass("empty")&&e.find("tbody").empty(),d.find(".modal-table").DataTable({language:{searchPlaceholder:"Search users",emptyTable:"There are no users"},scrollY:"350px",scrollX:!0,paging:!1,bInfo:!1})}))}))}))}))}}}));