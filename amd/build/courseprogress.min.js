define(["jquery","core/modal_factory","core/modal_events","core/fragment","core/templates","local_sitereport/variables","local_sitereport/jquery.dataTables","local_sitereport/dataTables.bootstrap4","local_sitereport/common"],(function(e,a,t,o,r,l){return{init:function(r){var s="#wdm-courseprogress-individual",d=s+" .table",n=s+" .loader",i=null,c=0,u=e(s).data("sesskey"),m=l.requestUrl+"?action=get_courseprogress_graph_data_ajax&sesskey="+u;function p(a){e(d).show(),e(n).hide();var t=JSON.stringify({courseid:"all",cohortid:a});i=e(d).DataTable({ajax:m+"&cohortid="+a+"&data="+t,columns:[{data:"coursename"},{data:"enrolments"},{data:"completed100"},{data:"completed80"},{data:"completed60"},{data:"completed40"},{data:"completed20"},{data:"completed00"}],columnDefs:[{className:"text-left",targets:0},{className:"text-center modal-trigger",targets:"_all"}],language:{searchPlaceholder:"Search courses",emptyTable:"There are no courses"},drawCallback:function(){e(".dataTables_paginate > .pagination").addClass("pagination-sm pull-right"),e(".dataTables_filter").addClass("pagination-sm pull-right")},bInfo:!1})}e(document).ready((function(){p(c),e(document).on("click","#cohortfilter ~ .dropdown-menu .dropdown-item",(function(){i&&(i.destroy(),e(d).hide(),e(n).show()),c=e(this).data("cohortid"),e("#cohortfilter").html(e(this).text()),p(c)})),e(document).on("click","#wdm-courseprogress-individual .table a.modal-trigger",(function(){var l=e(this).data("minvalue"),s=e(this).data("maxvalue"),d=e(this).data("courseid"),n=e(this).data("coursename"),i=null;a.create({body:o.loadFragment("local_sitereport","userslist",r,{page:"courseprogress",courseid:d,minval:l,maxval:s,cohortid:c})}).then((function(e){i=e.getRoot(),e.setTitle(n),e.show(),i.on(t.hidden,(function(){e.destroy()})),i.on(t.bodyRendered,(function(){var e=i.find(".modal-table");e.find("tbody").hasClass("empty")&&e.find("tbody").empty(),i.find(".modal-table").DataTable({language:{searchPlaceholder:"Search users",emptyTable:"There are no users"},scrollY:"350px",scrollX:!0,paging:!1,bInfo:!1})}))}))}))}))}}}));